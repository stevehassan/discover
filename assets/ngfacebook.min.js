angular.module("ngFacebook",[]).provider("$facebook",function(){var e={appId:null,status:!0,cookie:!0,xfbml:!0,version:"v2.6",permissions:"email",customInit:{}};this.setAppId=function(n){return e.appId=n,this},this.getAppId=function(){return e.appId},this.setVersion=function(n){return e.version=n,this},this.getVersion=function(){return e.version},this.setPermissions=function(n){return n instanceof Array&&n.join(","),e.permissions=n,this},this.getPermissions=function(){return e.permissions},this.setCustomInit=function(n){return angular.isDefined(n.appId)&&this.setAppId(n.appId),e.customInit=n,this},this.getCustomInit=function(){return e.customInit},this.$get=["$q","$rootScope","$window",function(n,t,o){function r(e){a||(a=!0,s.resolve(e))}var i=n.defer();i.config=function(n){return e[n]},i.init=function(){if(null==i.config("appId"))throw"$facebookProvider: `appId` cannot be null";o.FB.init(angular.extend({appId:i.config("appId"),status:i.config("status"),cookie:i.config("cookie"),xfbml:i.config("xfbml"),version:i.config("version")},i.config("customInit"))),t.$broadcast("fb.load",o.FB)},t.$on("fb.load",function(e,n){i.resolve(n),angular.forEach(["auth.login","auth.logout","auth.prompt","auth.sessionChange","auth.statusChange","auth.authResponseChange","xfbml.render","edge.create","edge.remove","comment.create","comment.remove","message.send"],function(e){n.Event.subscribe(e,function(o){t.$broadcast("fb."+e,o,n),t.$$phase||t.$apply()})}),i.getLoginStatus(),i.canvasSetAutoResize()}),i._cache={},i.setCache=function(e,n){i._cache[e]=n},i.getCache=function(e){return angular.isUndefined(i._cache[e])?!1:i._cache[e]},i.clearCache=function(){i._cache={}};var s=n.defer(),a=!1;return i.setCache("connected",null),i.isConnected=function(){return i.getCache("connected")},t.$on("fb.auth.authResponseChange",function(e,n,t){i.clearCache(),"connected"==n.status?i.setCache("connected",!0):"not_authorized"===n.status?i.setCache("connected",!0):i.setCache("connected",!1),r(t)}),i.getAuthResponse=function(){return FB.getAuthResponse()},i.getLoginStatus=function(e){var o=n.defer();return i.promise.then(function(n){return n.getLoginStatus(function(e){e.error?o.reject(e.error):(o.resolve(e),null==i.isConnected()&&t.$broadcast("fb.auth.authResponseChange",e,n)),t.$$phase||t.$apply()},e),o.promise})},i.login=function(e,o){void 0==e&&(e=i.config("permissions"));var r=n.defer(),s={scope:e};return o&&(s.auth_type="rerequest"),i.promise.then(function(e){return e.login(function(e){e.error?r.reject(e.error):r.resolve(e),t.$$phase||t.$apply()},s),r.promise})},i.logout=function(){var e=n.defer();return i.promise.then(function(n){return n.logout(function(n){n.error?e.reject(n.error):e.resolve(n),t.$$phase||t.$apply()}),e.promise})},i.ui=function(e){var o=n.defer();return i.promise.then(function(n){return n.ui(e,function(e){e&&e.error_code?o.reject(e.error_message):o.resolve(e),t.$$phase||t.$apply()}),o.promise})},i.api=function(){var e=n.defer(),o=arguments;return o[o.length++]=function(n){n.error&&e.reject(n.error),n.error_msg?e.reject(n):e.resolve(n),t.$$phase||t.$apply()},s.promise.then(function(n){return n.api.apply(n,o),e.promise})},i.cachedApi=function(){if("string"!=typeof arguments[0])throw"$facebook.cacheApi works only with graph requests!";var e=i.getCache(arguments[0]);if(e)return e;var n=i.api.apply(i,arguments);return i.setCache(arguments[0],n),n},i.canvasSetAutoGrow=function(){return FB.Canvas.setAutoGrow()},i.canvasScrollTop=function(e,n){return FB.Canvas.scrollTo(e,n)},i.canvasSetAutoResize=function(){setInterval(function(){if(FB){var e=angular.element(document.querySelector("body"))[0].offsetHeight;return FB.Canvas.setSize({height:e})}},500)},i}]}).run(["$rootScope","$window","$facebook",function(e,n,t){n.fbAsyncInit=function(){t.init(),e.$$phase||e.$apply()}}]);