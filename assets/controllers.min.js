function chunk(e,t){for(var o=[];e.length>0;)o.push(e.splice(0,t));return o}var discoverApp=angular.module("myModule",["titleService","studyService","displayService","xmlService","ui.bootstrap","ngRoute","ngAnimate","ngSanitize","ngFacebook"]);discoverApp.run(["$rootScope","$window","$facebook",function(e,t,o){!function(e,t,r){var n,i=e.getElementsByTagName(t)[0];e.getElementById(r)||(n=e.createElement(t),n.id=r,n.src="//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6&appId="+o.config("appId"),i.parentNode.insertBefore(n,i))}(document,"script","facebook-jssdk"),e.$on("fb.load",function(){t.dispatchEvent(new Event("fb.load"))})}]),discoverApp.config(["$facebookProvider",function(e){e.setAppId("123456789876543").setPermissions(["email","user_friends"])}]),discoverApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"partials/home.html",controller:"homeController"}).when("/home",{templateUrl:"partials/home.html",controller:"homeController"}).when("/about",{templateUrl:"partials/about.html",controller:"aboutController"}).when("/search",{templateUrl:"partials/search.html",controller:"searchController"}).when("/login",{templateUrl:"partials/login.html",controller:"loginController"}).when("/login/:studyId",{templateUrl:"partials/login.html",controller:"loginController"}).when("/json/:studyId",{templateUrl:"partials/json.html",controller:"jsonController"}).when("/study/:studyId",{templateUrl:"partials/study.html",controller:"studyController"})}]),discoverApp.controller("navigationController",["$scope","$location",function(e,t){$(".nav a").on("click",function(){"none"!=$(".navbar-toggle").css("display")&&$(".collapse").collapse("hide")}),e.isActive=function(e){var o=e===t.path();return o}}]),discoverApp.controller("homeController",["$scope",function(e){e.date=new Date}]),discoverApp.controller("aboutController",["$scope",function(){}]),discoverApp.controller("loginController",["$scope","$facebook","$routeParams","$timeout",function(e,t,o){$(document).ready(function(){o.studyId&&(e.studyId=o.studyId)}),$("#friends-toggle").on("click",function(){var e=$(this);$("#friends-toggle").html("Hide"==e.text()?"Show":"Hide")}),e.$on("fb.auth.authResponseChange",function(){e.status=t.isConnected(),e.status&&t.api("/me?fields=id,name,picture,email").then(function(t){e.user=t})}),$("#friends-btn").on("click",function(){if(e.status){var o=$(this).button("loading");t.api("/me/taggable_friends?limit=5000").then(function(t){e.colSpan=4,e.chunkedFriends=chunk(t.data,12/e.colSpan),o.button("reset")})}})}]),discoverApp.controller("searchController",["$scope","$sce","$filter","Title","Study","Display","Xml",function(e,t,o,r,n,i){e.currentPage=1,e.itemsPerPage=10,e.maxSize=5,e.items=r.query(function(){""!==e.sort.sortingOrder&&(e.filtered=o("orderBy")(e.filtered,e.sort.sortingOrder,e.sort.reverse))}),e.sort={sortingOrder:"id",reverse:!1},e.selectItem=function(t){return t.isSelected?void(t.isSelected=!1):(n.get(t.id,function(e){i.getDisplay(e,t)}),angular.forEach(e.filtered,function(e){e.isSelected=!1}),void(t.isSelected=!0))},e.closeItem=function(e){e.isSelected=!1}}]),discoverApp.controller("jsonController",["$scope","$routeParams","Study",function(e,t,o){t.studyId&&o.get(t.studyId,function(t){e.json=xmlToJson(t)})}]),discoverApp.controller("studyController",["$scope","$location","$sce","$routeParams","Study","Display","Xml",function(e,t,o,r,n,i){r.studyId&&(e.url=t.absUrl(),n.get(r.studyId,function(t){e.item=[],e.item.id=r.studyId,i.getDisplay(t,e.item)}))}]),discoverApp.directive("customSort",function(){return{restrict:"A",transclude:!0,scope:{order:"=",sort:"="},template:' <a ng-click="sort_by(order)" style="color: #555555; cursor: pointer">    <span ng-transclude></span>    <i ng-class="selectedCls(order)"></i></a>',link:function(e){e.sort_by=function(t){var o=e.sort;o.sortingOrder==t&&(o.reverse=!o.reverse),o.sortingOrder=t},e.selectedCls=function(t){return t==e.sort.sortingOrder?"icon-chevron-"+(e.sort.reverse?"down":"up"):"icon-sort"}}}}),discoverApp.directive("bindHtmlCompile",["$compile",function(e){return{restrict:"A",link:function(t,o,r){t.$watch(function(){return t.$eval(r.bindHtmlCompile)},function(r){o.html(r),e(o.contents())(t)})}}}]),discoverApp.directive("fbParse",["$rootScope",function(){return function(e,t){try{FB&&FB.XFBML.parse(t[0])}catch(o){}}}]),discoverApp.filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}});